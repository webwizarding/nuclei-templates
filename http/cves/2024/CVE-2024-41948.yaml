id: CVE-2024-41948

info:
  name: Public Key Confusion in Third Party Block in Biscuit-Java
  author: HORNYMOMS
  tags: cve,cve2024,biscuit-java,public-key-confusion,misconfiguration
  severity: low
  description: |
    Biscuit-Java versions >= 3.0.0 and < 4.0.0 are vulnerable to public key confusion in third-party block generation. A malicious user can forge a third-party block request, altering the public key used in the request, leading to incorrect trust relationships and potential unauthorized actions.
  reference:
    - https://github.com/biscuit-auth/biscuit-java/security/advisories/GHSA-5hcj-rwm6-xmw4
  classification:
    cve-id: CVE-2024-41948
    cwe-id: CWE-1259
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:L/A:N
    cvss-score: 3.0
  metadata:
    cpe: cpe:2.3:a:biscuitsec:biscuit-java:*:*:*:*:*:*:*:*
    affected-versions:
      - ">= 3.0.0, < 4.0.0"

requests:
  - method: POST
    path:
      - "{{BaseURL}}/third-party-block"

    body: |
      {
        "previous_block_public_key": "{{FuzzPublicKey}}",
        "symbol_table_public_keys": ["{{FuzzPublicKey1}}", "{{FuzzPublicKey2}}"]
      }

    headers:
      Content-Type: application/json

    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "trusted"
        part: body
